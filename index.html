<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" />
  <title>NoteCar Online | Professional Control</title>

  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;600;700;800&family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

  <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-database-compat.js"></script>

  <style>
    :root { --primary: #ff7a18; --bg: #030509; --glass: rgba(255, 255, 255, 0.04); --glass-border: rgba(255, 255, 255, 0.1); }
    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-family: 'Sarabun', sans-serif; }
    body { margin: 0; background-color: var(--bg); color: #f1f5f9; overflow-x: hidden; }

    /* Header */
    .nav-header { position: fixed; top: 0; left: 0; right: 0; height: 70px; background: rgba(3, 5, 9, 0.85); backdrop-filter: blur(15px); display: flex; justify-content: space-between; align-items: center; padding: 0 5%; z-index: 2000; border-bottom: 1px solid var(--glass-border); }
    .brand { display: flex; align-items: center; gap: 10px; cursor: pointer; }
    .brand img { width: 38px; height: 38px; border-radius: 10px; border: 1px solid var(--primary); }
    .brand-text { font-family: 'Kanit'; font-weight: 800; font-size: 1.3rem; color: var(--primary); }
    .nav-tools { display: flex; gap: 12px; align-items: center; }
    .lang-switcher { background: #1a202c; border: 1px solid var(--glass-border); padding: 3px; border-radius: 10px; display: flex; }
    .lang-btn { padding: 6px 12px; border-radius: 8px; border: none; background: transparent; color: #718096; cursor: pointer; font-family: 'Kanit'; font-weight: 700; font-size: 0.75rem; }
    .lang-btn.active { background: var(--primary); color: white; }
    
    /* Admin Buttons */
    .admin-icon-btn { background: none; border: none; cursor: pointer; font-size: 1.4rem; transition: 0.3s; }
    .fingerprint-btn { color: rgba(255,255,255,0.2); }
    .logout-btn { color: #ef4444; }

    /* Layout */
    .shell { width: 92%; max-width: 1200px; margin: 90px auto 30px; }
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(290px, 1fr)); gap: 20px; }
    @media (max-width: 600px) { .grid { grid-template-columns: 1fr; } }
    .car-card { background: var(--glass); border-radius: 28px; border: 1px solid var(--glass-border); overflow: hidden; position: relative; transition: 0.3s; }
    .car-img { width: 100%; aspect-ratio: 16/10; object-fit: cover; }
    .status-tag { position: absolute; top: 12px; left: 12px; padding: 5px 14px; border-radius: 10px; font-size: 0.65rem; font-weight: 800; font-family: 'Kanit'; color: white; z-index: 10; }

    /* Buttons */
    .btn-texture { border: none; border-radius: 15px; cursor: pointer; font-family: 'Kanit'; font-weight: 700; padding: 12px 20px; display: flex; align-items: center; justify-content: center; gap: 8px; color: white; }
    .btn-orange { background: linear-gradient(180deg, #ff9d5c 0%, #ff7a18 100%); }
    .btn-blue { background: #1877f2; }
    .btn-dark { background: #1f2937; border: 1px solid var(--glass-border); }
    .btn-red { background: #ef4444; }

    /* Comment Area */
    .comment-card { background: var(--glass); padding: 20px; border-radius: 24px; margin-bottom: 12px; border: 1px solid var(--glass-border); position: relative; }
    .comment-user { font-family: 'Kanit'; color: var(--primary); font-weight: 700; font-size: 0.9rem; }
    .comment-location { font-size: 0.65rem; background: rgba(255,255,255,0.08); padding: 3px 10px; border-radius: 8px; color: #94a3b8; margin-left: 8px; }
    .comment-msg { font-size: 0.95rem; color: #cbd5e1; margin: 10px 0; }
    .comment-time { font-size: 0.7rem; color: #475569; }
    .comment-input-box { position: sticky; bottom: 20px; background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(10px); padding: 12px 20px; border-radius: 20px; border: 1px solid var(--primary); display: flex; gap: 10px; margin-top: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
    #commentInput { flex: 1; background: transparent; border: none; color: white; outline: none; font-size: 1rem; }

    /* Modals */
    .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.9); display: none; align-items: center; justify-content: center; z-index: 5000; backdrop-filter: blur(8px); }
    .pop-card { background: #0f172a; padding: 35px; border-radius: 35px; text-align: center; max-width: 360px; width: 90%; border: 1px solid var(--glass-border); }
    input, select { width: 100%; padding: 14px; border-radius: 12px; margin-bottom: 12px; background: #111; color: white; border: 1px solid var(--glass-border); }
    #adminPanel { display: none; border: 1px solid var(--primary); padding: 25px; border-radius: 28px; margin-bottom: 30px; }
    #restoreBtn { display: none; position: fixed; bottom: 100px; right: 20px; z-index: 1500; }
    #successToast { display: none; position: fixed; bottom: 100px; left: 50%; transform: translateX(-50%); background: #22c55e; color: white; padding: 10px 25px; border-radius: 50px; z-index: 10000; }
  </style>
</head>
<body>

  <header class="nav-header">
    <div class="brand" onclick="location.reload()">
      <img src="Icon.png">
      <div class="brand-text">NOTECAR</div>
    </div>
    <div class="nav-tools">
      <div class="lang-switcher">
        <button id="btnTH" class="lang-btn active" onclick="setLang('th')">TH</button>
        <button id="btnEN" class="lang-btn" onclick="setLang('en')">EN</button>
      </div>
      <div id="adminAuthBtn">
          <button onclick="openLogin()" class="admin-icon-btn fingerprint-btn"><i class="fa-solid fa-fingerprint"></i></button>
      </div>
    </div>
  </header>

  <div id="welcomeOverlay" class="modal-overlay" style="display: flex;">
    <div class="pop-card animate__animated animate__zoomIn">
      <img src="Icon.png" style="width:80px; height:80px; border-radius:20px; margin-bottom:15px; border:2px solid var(--primary);">
      <h2 id="welTitle">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö</h2>
      <p id="welSub">‡∏Ñ‡∏±‡∏î‡∏£‡∏ñ‡∏™‡∏ß‡∏¢ ‡∏™‡∏†‡∏≤‡∏û‡∏î‡∏µ ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏±‡∏ô‡πÄ‡∏≠‡∏á üß°</p>
      <button onclick="enterSite()" class="btn-texture btn-orange" style="width:100%;" id="startBtn">‡πÄ‡∏Ç‡πâ‡∏≤‡∏ä‡∏°‡∏£‡∏ñ‡πÉ‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å</button>
    </div>
  </div>

  <button id="restoreBtn" onclick="openAdminPanel()" class="btn-texture btn-orange animate__animated animate__bounceIn">
    <i class="fa-solid fa-plus"></i> <span id="txtRestore">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÉ‡∏´‡∏°‡πà</span>
  </button>

  <div id="successToast" class="animate__animated">‚úì ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</div>

  <div class="shell">
    <div id="adminPanel" class="animate__animated">
      <h4 id="txtAdminTitle" style="margin:0 0 15px 0; font-family:'Kanit';">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ï‡πá‡∏≠‡∏Å</h4>
      <input type="text" id="carTitle" placeholder="‡∏£‡∏∏‡πà‡∏ô‡∏£‡∏ñ">
      <input type="text" id="carPrice" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤">
      <label for="carFile" style="display:block; padding:15px; border:2px dashed var(--glass-border); border-radius:15px; text-align:center; cursor:pointer; margin-bottom:12px;">
        <i class="fa-solid fa-image"></i> <span id="txtUpload">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</span>
      </label>
      <input type="file" id="carFile" accept="image/*" style="display:none" onchange="document.getElementById('txtUpload').innerText = this.files[0].name">
      <select id="carStatus">
        <option value="available" id="optAvail">üü¢ ‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</option>
        <option value="sold" id="optSold">üî¥ ‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß</option>
      </select>
      <div style="display:flex; gap:10px;">
        <button id="uploadBtn" class="btn-texture btn-orange" style="flex:2;" onclick="startUpload()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
        <button onclick="cancelAdmin()" class="btn-texture btn-dark" style="flex:1;">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
      </div>
    </div>

    <div id="carList" class="grid"></div>

    <div class="comment-area" style="margin-top:50px;">
      <h3 id="txtComTitle" style="font-family:'Kanit';">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô</h3>
      <div id="commentDisplay"></div>
      <div class="comment-input-box">
        <input type="text" id="commentInput" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°...">
        <button onclick="handleComment()" class="btn-texture btn-orange" style="padding: 10px 15px; border-radius: 12px;"><i class="fa-solid fa-paper-plane"></i></button>
      </div>
    </div>
  </div>

  <div id="loginModal" class="modal-overlay">
    <div class="pop-card animate__animated animate__fadeInUp">
      <h3><i class="fa-solid fa-fingerprint"></i> Admin Login</h3>
      <input type="password" id="adminPass" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" style="text-align:center;">
      <div style="display:flex; gap:10px;">
          <button onclick="checkLogin()" class="btn-texture btn-orange" style="flex:1;">‡∏ï‡∏Å‡∏•‡∏á</button>
          <button onclick="closeLogin()" class="btn-texture btn-dark" style="flex:1;">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
      </div>
    </div>
  </div>

  <div id="nameModal" class="modal-overlay">
    <div class="pop-card animate__animated animate__zoomIn">
      <div style="font-size: 3.5rem; color: var(--primary); margin-bottom: 15px;"><i class="fa-solid fa-circle-user"></i></div>
      <h3 id="txtAskName">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å</h3>
      <p id="txtAskNameSub" style="color:gray; font-size:0.85rem; margin-bottom:20px;">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏û‡∏π‡∏î‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤</p>
      <input type="text" id="userNameInput" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì..." style="text-align:center; font-size: 1.1rem; border: 1px solid var(--primary);">
      <button onclick="saveCommentWithName()" class="btn-texture btn-orange" style="width:100%;">‡∏ï‡∏Å‡∏•‡∏á</button>
    </div>
  </div>

  <div id="confirmModal" class="modal-overlay">
    <div class="pop-card animate__animated animate__zoomIn" style="border: 1px solid #ef4444;">
        <div style="font-size: 3rem; color: #ef4444; margin-bottom: 15px;"><i class="fa-solid fa-circle-exclamation"></i></div>
        <h3 id="confirmTitle">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö?</h3>
        <p id="confirmSub">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡πÑ‡∏î‡πâ</p>
        <div style="display:flex; gap:10px;">
            <button id="btnConfirmAction" class="btn-texture btn-red" style="flex:1;">‡∏•‡∏ö‡πÄ‡∏•‡∏¢</button>
            <button onclick="closeConfirm()" class="btn-texture btn-dark" style="flex:1;">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
        </div>
    </div>
  </div>

  <script>
    const translations = {
      th: {
        welTitle: "‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà NoteCar Online", welSub: "‡∏Ñ‡∏±‡∏î‡∏£‡∏ñ‡∏™‡∏ß‡∏¢ ‡∏™‡∏†‡∏≤‡∏û‡∏î‡∏µ ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏±‡∏ô‡πÄ‡∏≠‡∏á üß°", startBtn: "‡πÄ‡∏Ç‡πâ‡∏≤‡∏ä‡∏°‡∏£‡∏ñ‡πÉ‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å",
        btnChat: "‡πÅ‡∏ä‡∏ó", btnCall: "‡πÇ‡∏ó‡∏£", availTag: "‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà", soldTag: "‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß",
        txtAdminTitle: "‚öôÔ∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ï‡πá‡∏≠‡∏Å", txtRestore: "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÉ‡∏´‡∏°‡πà", txtUpload: "‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û",
        optAvail: "üü¢ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡∏≤‡∏¢", optSold: "üî¥ ‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß", uploadBtn: "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
        txtComTitle: "üí¨ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î", commentInput: "‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°...", 
        confirmTitle: "‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö?", confirmSub: "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£ ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡πÑ‡∏î‡πâ", btnConfirmAction: "‡∏•‡∏ö‡πÄ‡∏•‡∏¢", btnDel: "‡∏•‡∏ö",
        txtAskName: "‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å", txtAskNameSub: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏û‡∏π‡∏î‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤"
      },
      en: {
        welTitle: "Welcome to NoteCar Online", welSub: "Premium cars at friendly prices üß°", startBtn: "View Inventory",
        btnChat: "CHAT", btnCall: "CALL", availTag: "AVAILABLE", soldTag: "SOLD OUT",
        txtAdminTitle: "‚öôÔ∏è Stock Management", txtRestore: "Restart Post", txtUpload: "Upload Image",
        optAvail: "üü¢ Available", optSold: "üî¥ Sold Out", uploadBtn: "Save Post",
        txtComTitle: "üí¨ Latest Comments", commentInput: "Write a comment...", 
        confirmTitle: "Are you sure?", confirmSub: "This action cannot be undone.", btnConfirmAction: "Delete Now", btnDel: "DEL",
        txtAskName: "Nice to meet you", txtAskNameSub: "Please enter your name to continue"
      }
    };

    let currentLang = 'th', isAdmin = false, editMode = false, editKey = null, deletePath = null, tempComment = "";
    
    const firebaseConfig = { apiKey: "AIzaSyANA3-UyKf-MS2dcmbAuPGt-KtRd0KTmGw", databaseURL: "https://note-communitycar-default-rtdb.asia-southeast1.firebasedatabase.app", projectId: "note-communitycar" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function setLang(lang) {
      currentLang = lang;
      document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
      document.getElementById('btn' + lang.toUpperCase()).classList.add('active');
      const t = translations[lang];
      for (let id in t) {
        let el = document.getElementById(id);
        if (el && el.tagName !== "BUTTON") {
            if (el.tagName === "INPUT") el.placeholder = t[id];
            else if (el.tagName === "OPTION") el.text = t[id];
            else el.innerText = t[id];
        }
      }
      renderCars(); loadComments();
    }

    function enterSite() { document.getElementById('welcomeOverlay').style.display = 'none'; }
    function openLogin() { document.getElementById('loginModal').style.display = 'flex'; }
    function closeLogin() { document.getElementById('loginModal').style.display = 'none'; document.getElementById('adminPass').value = ''; }

    function checkLogin() {
      if(document.getElementById('adminPass').value === "Note#2026!Car@Phupha99") {
        isAdmin = true;
        document.getElementById('loginModal').style.display = 'none';
        document.getElementById('adminAuthBtn').innerHTML = `<button onclick="logoutAdmin()" class="admin-icon-btn logout-btn"><i class="fa-solid fa-right-from-bracket"></i></button>`;
        openAdminPanel();
        loadComments(); renderCars();
        showToast("Admin Mode Active");
      } else alert("‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");
    }

    function logoutAdmin() {
        isAdmin = false;
        document.getElementById('adminPanel').style.display = 'none';
        document.getElementById('restoreBtn').style.display = 'none';
        document.getElementById('adminAuthBtn').innerHTML = `<button onclick="openLogin()" class="admin-icon-btn fingerprint-btn"><i class="fa-solid fa-fingerprint"></i></button>`;
        loadComments(); renderCars();
        showToast("Logged Out");
    }

    function openAdminPanel() { document.getElementById('adminPanel').style.display = 'block'; document.getElementById('restoreBtn').style.display = 'none'; }
    function cancelAdmin() { document.getElementById('adminPanel').style.display = 'none'; if(isAdmin) document.getElementById('restoreBtn').style.display = 'flex'; }

    async function getProvince() {
        try {
            const res = await fetch('http://ip-api.com/json/?fields=status,regionName');
            const data = await res.json();
            return data.status === 'success' ? data.regionName : "Unknown";
        } catch(e) { return "Unknown"; }
    }

    async function handleComment() {
      const input = document.getElementById('commentInput');
      tempComment = input.value;
      if(!tempComment) return;

      let name = localStorage.getItem('noteCarUserName');
      if(!name) {
          const t = translations[currentLang];
          document.getElementById('txtAskName').innerText = t.txtAskName;
          document.getElementById('txtAskNameSub').innerText = t.txtAskNameSub;
          document.getElementById('nameModal').style.display = 'flex';
          return;
      }
      executePushComment(name, tempComment);
      input.value = "";
    }

    async function saveCommentWithName() {
        const nInput = document.getElementById('userNameInput');
        const name = nInput.value.trim();
        if(name) {
            localStorage.setItem('noteCarUserName', name);
            document.getElementById('nameModal').style.display = 'none';
            executePushComment(name, tempComment);
            document.getElementById('commentInput').value = "";
        }
    }

    async function executePushComment(name, text) {
        const province = await getProvince();
        db.ref('comments').push({ name, text, location: province, timestamp: Date.now() });
    }

    function renderCars() {
      db.ref('cars').on('value', snap => {
        const list = document.getElementById('carList'); list.innerHTML = "";
        const data = snap.val(); const t = translations[currentLang];
        if(data) Object.keys(data).reverse().forEach(key => {
          const car = data[key];
          list.innerHTML += `
            <div class="car-card animate__animated animate__fadeIn">
              <div class="status-tag" style="background:${car.status==='available'?'#16a34a':'#dc2626'}">${car.status==='available' ? t.availTag : t.soldTag}</div>
              <img src="${car.img}" class="car-img">
              <div style="padding:20px;">
                <h3 style="color:white; font-family:'Kanit';">${car.title}</h3>
                <div style="font-size:1.8rem; font-weight:800; color:var(--primary); margin:10px 0;">‡∏ø${car.price}</div>
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;">
                  <a href="https://m.me/note.notety.5" target="_blank" class="btn-texture btn-blue" style="text-decoration:none;">${t.btnChat}</a>
                  <a href="tel:0835255642" class="btn-texture btn-dark" style="text-decoration:none;">${t.btnCall}</a>
                </div>
                ${isAdmin ? `<div style="display:flex; gap:8px; margin-top:12px;"><button onclick="editPost('${key}','${car.title}','${car.price}','${car.status}','${car.img}')" class="btn-texture btn-dark" style="flex:1; font-size:0.75rem;">EDIT</button><button onclick="triggerDelete('cars/${key}')" class="btn-texture btn-red" style="flex:1; font-size:0.75rem;">DEL</button></div>` : ''}
              </div>
            </div>`;
        });
      });
    }

    function loadComments() {
      db.ref('comments').on('value', snap => {
        const display = document.getElementById('commentDisplay'); display.innerHTML = "";
        const data = snap.val(); const t = translations[currentLang];
        if(data) Object.keys(data).reverse().forEach(key => {
          const c = data[key];
          display.innerHTML += `
            <div class="comment-card animate__animated animate__fadeIn">
              <div class="comment-user">@ ${c.name} <span class="comment-location"><i class="fa-solid fa-location-dot"></i> ${c.location}</span></div>
              <div class="comment-msg">${c.text}</div>
              <div class="comment-time">${new Date(c.timestamp).toLocaleString(currentLang === 'th' ? 'th-TH' : 'en-US')}</div>
              ${isAdmin ? `<button onclick="triggerDelete('comments/${key}')" style="position:absolute; top:15px; right:15px; background:#ef4444; color:white; border:none; border-radius:8px; padding:5px 12px; cursor:pointer; font-size:0.75rem;"><i class="fa-solid fa-trash"></i> ${t.btnDel}</button>` : ''}
            </div>`;
        });
      });
    }

    function triggerDelete(path) { 
        deletePath = path; 
        const t = translations[currentLang];
        document.getElementById('confirmTitle').innerText = t.confirmTitle;
        document.getElementById('confirmSub').innerText = t.confirmSub;
        document.getElementById('confirmModal').style.display = 'flex'; 
    }
    function closeConfirm() { document.getElementById('confirmModal').style.display = 'none'; }
    document.getElementById('btnConfirmAction').onclick = function() {
        if(deletePath) db.ref(deletePath).remove().then(() => { closeConfirm(); showToast(currentLang === 'th' ? "‡∏•‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à" : "Deleted"); });
    }
    function showToast(m) { const t = document.getElementById('successToast'); t.innerText = m; t.style.display='block'; t.classList.add('animate__fadeInUp'); setTimeout(()=>t.style.display='none', 2500); }

    setLang('th');
  </script>
</body>
</html>
