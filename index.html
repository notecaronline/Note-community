            
            setTimeout(() => location.reload(), 1000);
        } catch (err) {
            console.error(err);
            showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà');
            uploadBtn.disabled = false;
            uploadBtn.textContent = editMode ? "‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï" : "‡∏•‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®";
        }
    }

    function renderCars() {
        const list = document.getElementById('carList');
        list.innerHTML = '<div class="loading"><div class="spinner"></div>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>';
        
        db.ref('cars').once('value', snapshot => {
            list.innerHTML = "";
            const data = snapshot.val();
            
            if(data) {
                const carsArray = Object.keys(data).map(key => ({
                    key,
                    ...data[key]
                }));
                
                carsArray.sort((a, b) => (b.time || 0) - (a.time || 0));
                
                carsArray.forEach(car => {
                    const statusText = car.status === 'available' ? '‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà' : '‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß';
                    const statusClass = car.status === 'available' ? 'tag-available' : 'tag-sold';
                    
                    list.innerHTML += `
                        <div class="car-card">
                            <div class="status-tag ${statusClass}">${statusText}</div>
                            <img src="${car.img}" class="car-img" alt="${car.title}" loading="lazy">
                            <div class="details">
                                <h2 class="car-title">üöó ${car.title}</h2>
                                <div class="price">‡∏ø${car.price}</div>
                                <div class="contact-area">
                                    <a href="https://m.me/note.notety.5" target="_blank" class="btn-contact btn-facebook">üí¨ ‡πÅ‡∏ä‡∏ó</a>
                                    <a href="tel:0835255642" class="btn-contact btn-phone">üìû ‡πÇ‡∏ó‡∏£</a>
                                </div>
                                <div class="phone-display">üìû ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠: 083-525-5642</div>
                                ${isAdmin ? `<div class="admin-controls">
                                    <button class="btn-edit" onclick="editPost('${car.key}', '${car.title.replace(/'/g, "\\'")}', '${car.price}', '${car.status}', '${car.img}')">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                                    <button class="btn-del" onclick="deletePost('${car.key}')">üóëÔ∏è ‡∏•‡∏ö</button>
                                </div>` : ''}
                            </div>
                        </div>`;
                });
            } else {
                list.innerHTML = `
                    <div class="empty-state">
                        <h3>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏ñ‡πÉ‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å</h3>
                        <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà...</p>
                    </div>
                `;
            }
        });
    }

    function editPost(key, title, price, status, img) {
        editMode = true;
        editKey = key;
        existingImgUrl = img;
        
        document.getElementById('adminPanel').style.display = 'block';
        document.getElementById('carTitle').value = title;
        document.getElementById('carPrice').value = price;
        document.getElementById('carStatus').value = status;
        document.getElementById('uploadBtn').textContent = '‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
        document.getElementById('cancelEditBtn').style.display = 'block';
        
        const fileLabel = document.querySelector('.file-label');
        fileLabel.textContent = 'üìÅ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏´‡∏°‡πà = ‡πÉ‡∏ä‡πâ‡∏£‡∏π‡∏õ‡πÄ‡∏î‡∏¥‡∏°)';
        
        window.scrollTo({top: 0, behavior: 'smooth'});
        showToast('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®');
    }

    function cancelEdit() {
        editMode = false;
        editKey = null;
        existingImgUrl = null;
        
        document.getElementById('carTitle').value = '';
        document.getElementById('carPrice').value = '';
        document.getElementById('carStatus').value = 'available';
        document.getElementById('carFile').value = '';
        document.getElementById('uploadBtn').textContent = '‡∏•‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®';
        document.getElementById('cancelEditBtn').style.display = 'none';
        
        const fileLabel = document.querySelector('.file-label');
        fileLabel.textContent = 'üìÅ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û';
        fileLabel.style.background = 'linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%)';
        fileLabel.style.borderColor = 'var(--accent)';
        fileLabel.style.color = 'var(--accent-dark)';
    }

    function deletePost(id) { 
        if(confirm("‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏µ‡πâ?")) {
            db.ref(`cars/${id}`).remove()
                .then(() => {
                    showToast('‡∏•‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                    setTimeout(() => renderCars(), 500);
                })
                .catch(err => {
                    console.error(err);
                    showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö');
                });
        }
    }
    
    function showToast(message) {
        const existingToast = document.querySelector('.toast');
        if (existingToast) existingToast.remove();
        
        const toast = document.createElement('div');
        toast.className = 'toast';
        toast.textContent = message;
        document.body.appendChild(toast);
        
        setTimeout(() => toast.classList.add('show'), 100);
        setTimeout(() => {
            toast.classList.remove('show');
            setTimeout(() => toast.remove(), 300);
        }, 3000);
    }
    
    renderCars();
                                <div class="price">‡∏ø${car.price}</div>
                                <div class="contact-area">
                                    <a href="https://m.me/note.notety.5" target="_blank" class="btn-contact btn-facebook">üí¨ ‡πÅ‡∏ä‡∏ó</a>
                                    <a href="tel:0835255642" class="btn-contact btn-phone">üìû ‡πÇ‡∏ó‡∏£</a>
                                </div>
                                <div class="phone-display">üìû ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠: 083-525-5642</div>
                                ${isAdmin ? `<div class="admin-controls">
                                    <button class="btn-edit" onclick="editPost('${car.key}', '${car.title.replace(/'/g, "\\'")}', '${car.price}', '${car.status}', '${car.img}')">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                                    <button class="btn-del" onclick="deletePost('${car.key}')">üóëÔ∏è ‡∏•‡∏ö</button>
                                </div>` : ''}
                            </div>
                        </div>`;
                });
            } else {
                list.innerHTML = `
                    <div class="empty-state">
                        <h3>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏ñ‡πÉ‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å</h3>
                        <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà...</p>
                    </div>
                `;
            }
        });
    }

    function editPost(key, title, price, status, img) {
        editMode = true;
        editKey = key;
        existingImgUrl = img;
        
        document.getElementById('adminPanel').style.display = 'block';
        document.getElementById('carTitle').value = title;
        document.getElementById('carPrice').value = price;
        document.getElementById('carStatus').value = status;
        document.getElementById('uploadBtn').textContent = '‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
        document.getElementById('cancelEditBtn').style.display = 'block';
        
        const fileLabel = document.querySelector('.file-label');
        fileLabel.textContent = 'üìÅ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏´‡∏°‡πà = ‡πÉ‡∏ä‡πâ‡∏£‡∏π‡∏õ‡πÄ‡∏î‡∏¥‡∏°)';
        
        window.scrollTo({top: 0, behavior: 'smooth'});
        showToast('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®');
    }

    function cancelEdit() {
        editMode = false;
        editKey = null;
        existingImgUrl = null;
        
        document.getElementById('carTitle').value = '';
        document.getElementById('carPrice').value = '';
        document.getElementById('carStatus').value = 'available';
        document.getElementById('carFile').value = '';
        document.getElementById('uploadBtn').textContent = '‡∏•‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®';
        document.getElementById('cancelEditBtn').style.display = 'none';
        
        const fileLabel = document.querySelector('.file-label');
        fileLabel.textContent = 'üìÅ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û';
        fileLabel.style.background = 'linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%)';
        fileLabel.style.borderColor = 'var(--accent)';
        fileLabel.style.color = 'var(--accent-dark)';
    }

    function deletePost(id) { 
        if(confirm("‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏µ‡πâ?")) {
            db.ref(`cars/${id}`).remove()
                .then(() => {
                    showToast('‡∏•‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                    setTimeout(() => renderCars(), 500);
                })
                .catch(err => {
                    console.error(err);
                    showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö');
                });
        }
    }
    
    function showToast(message) {
        const existingToast = document.querySelector('.toast');
        if (existingToast) existingToast.remove();
        
        const toast = document.createElement('div');
        toast.className = 'toast';
        toast.textContent = message;
        document.body.appendChild(toast);
        
        setTimeout(() => toast.classList.add('show'), 100);
        setTimeout(() => {
            toast.classList.remove('show');
            setTimeout(() => toast.remove(), 300);
        }, 3000);
    }
    
    renderCars();
